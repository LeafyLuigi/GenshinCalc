<!DOCTYPE html>
<html>
	<title>Genshin Calculator</title>
	<link rel="stylesheet" href="style.css">
	<script type="text/javascript" src="chardb.js"></script>
	<script type="text/javascript" src="itemdb.js"></script>
	<script type="text/javascript" src="weapdb.js"></script>
	<script type="text/javascript" src="ascdb.js"></script>
	<script type="text/javascript" src="scripts.js"></script>
	<script type="text/javascript" src="scripts/cookieLocalStorage.js"></script>
	<script type="text/javascript" src="scripts/inventory.js"></script>
	<script type="text/javascript" src="scripts/charWeapHandling.js"></script>
	<body>
		<!-- TODO:save options? -->
		<!-- Options would include char/weap default target values (6/9/9/9 and 6 respectively). Not sure what else yet. -->
		<div>
			<a href="inv.html">Inventory</a>
		</div>
		<div class="vertFlex">
			<div>
				<label>Default <strong>target</strong> values for Character Ascension, Normal Attack, Skill and Burst:</label>
				<input type="number" id="defaultTargetAsc" size="3" max="6" min="0" value="6">
				<input type="number" id="defaultTargetTal1" size="3" max="10" min="1" value="9">
				<input type="number" id="defaultTargetTal2" size="3" max="10" min="1" value="9">
				<input type="number" id="defaultTargetTal3" size="3" max="10" min="1" value="9">
			</div>
			<div>
				<label>Default <strong>target</strong> value for Weapon Ascension</label>
				<input type="number" id="defaultWeaponAsc" size="3" max="6" min="0" value="6">
			</div>
		</div>
		<div class="addButtons">
			<div class="charDropdown">
				<button>
					<img id="dropdownCharIcon" class="dropdownCharImg" src="images/char/Unknown.png">
					<span id="dropdownCharName">Character</span>
				</button>
				<div class="dropdownContent" id="dropdownCharContent">
					<button onclick="pickChar(this.name)" name="Unknown">
						<img src="images/char/Unknown.png"><span>Unknown</span>
					</button>
				</div>
			</div>
			<button onclick="addCharacter(get('dropdownCharName').innerText)">Add Character</button>
			
			<div class="weaponDropdown">
				<button>
					<img id="dropdownWeaponIcon" class="dropdownWeaponImg" src="images/weapon/Unknown.png">
					<span id="dropdownWeaponName" rarity="0">Weapon</span>
				</button>
				<div class="dropdownContent" id="dropdownWeaponContent">
					<button onclick="pickWeapon(this.name,this.getAttribute('rarity'))" rarity="1" name="Unknown">
						<img src="images/weapon/Unknown.png"><span>Unknown</span>
					</button>
				</div>
			</div>
			<button onclick="addWeapon(get('dropdownWeaponName').innerText)">Add Weapon</button>
			
		</div>
		<div class="notes">Do note that only the first Traveler's Ascension gets counted</div>
		<div id="inputs"></div>
		<button class="testButton" onclick="test()">Click to calculate</button>
		<div class="invBlock empty">
			<div id="totalOutput"></div>
			<div id="whatDoYouHave"></div>
		</div>
		<div class="invBlock empty">
			<div id="whatToObtain"></div>
		</div>
		<div class="fakeTextbox" id="textOutput"></div>
		<footer style="font-size:12px;overflow-x:auto;">
			Images are copyrighted by miHoYo / HoYoverse. Data was obtained using the Fandom site. This site <strong>does not</strong> use Cookies but it does use Local Storage. You can view the repo <a href="https://github.com/LeafyLuigi/GenshinCalc">here</a>.
		</footer>
	</body>
	
	<script>
	'use strict';
	window.addEventListener("load", () => {
		// Generate Dropdown HTML
		var html = "";
		for (var i in chars) {
			var charName = i;
			var img = spaceToUnderscore(charName);
			if (charName != "Traveler") {
				html += "<button onclick=\"pickChar(this.name)\" name=\"" + charName + "\"><img class=\"dropdownCharImg\" src=\"images/char/" + img + ".png\"><span>" + charName + "</span></button>";
			} else {
				for (var j = 0; j < chars[i].regions.length; j++) {
					var travVariant = chars[i].regions[j];
					html += "<button onclick=\"pickChar(this.name,this.getAttribute(&quot;num&quot;))\" name=\"" + charName + "\" num=\"" + j + "\"><img class=\"dropdownCharImg\" src=\"images/char/" + img + ".png\"><span>" + travVariant.type + " " + charName + "</span></button>";
				}
			}
		}
		get("dropdownCharContent").innerHTML = html; html = "";
		for (var i in weapDB) {
			var weapName = i;
			var title = weapName;
			var rarity = weapDB[i].rarity;
			var img = spaceToUnderscore(weapName);
			if (weapDB[i].title != undefined) title = weapDB[i].title;
			html += "<button onclick=\"pickWeapon(this.name,this.getAttribute(&quot;rarity&quot;))\" rarity=\"" + rarity + "\" name=\"" + weapName + "\"><img class=\"dropdownWeaponImg\" src=\"images/weapon/" + img + ".png\"><span>" + title + "</span></button>";
		}
		get("dropdownWeaponContent").innerHTML = html; html = "";

		// try {
		// 	selectedChars = JSON.parse(getLSItem("selectedChars"))
		// }
		// catch {
		// }
		selectedChars = getSelectedChars();
		
		// console.log(selectedChars)
		if(selectedChars != null) {
			for(var i = 0; i < selectedChars.length; i++) {
				selectedCharsIndex = selectedChars.map(i => i.id);
				if(typeof(selectedChars[i].current) != "number") {
					addCharacter(selectedChars[i].name,true,selectedChars[i].id);
				} else {
					addWeapon(selectedChars[i].name,true,selectedChars[i].id);
				}
			}
		} else {
			selectedChars = [];
		}
	});
	</script>
</html>