<!DOCTYPE html>
<html>
	<head>
		<title>Genshin Calculator - Inventory</title>
		<link rel="stylesheet" href="style.css">
		<script type="text/javascript" src="loadData.js"></script>
		<script type="text/javascript" src="ascdb.js"></script>
		<script type="text/javascript" src="scripts.js"></script>
		<script type="text/javascript" src="scripts/cookieLocalStorage.js"></script>
		<script type="text/javascript" src="scripts/prefs.js"></script>
		<script type="text/javascript" src="scripts/inventory.js"></script>
		<script type="text/javascript" src="scripts/charWeapHandling.js"></script>
	</head>
	<body>
		<noscript>You need to enable JavaScript to use this page. It's all open source and no data is sent between this site and third parties. <a href="https://github.com/LeafyLuigi/GenshinCalc">Click here to view the GitHub Repo.</a></noscript>
		<div id="links"></div>
		<div id="prefsContainer"></div>
		<div class="invBlock" id="inventory">
			<div class="boxName">Inventory</div>
			<p>
				<em>You can hold Shift to adjust by 10 or CTRL (CMD on Mac) to adjust by 100.</em>
				<span>You can clear your inventory by clicking the button at the bottom of the page.</span>
			</p>
			<br>
			<div class="outputRequired" id="items">
				<div id="loading">
					<span class="loadingText">Loading...</span>
					<img class="loadingSpin" src="images/icons/loading.svg" height="64" width="64">
				</div>
			</div>
			<br>
			<div id="clearinvbutton" class="fauxButton clearInvButton">Clear Inventory</div>
		</div>
	</body>
	<script>
	'use strict';
	pageType = "inventory";
	var inv = parseLSItem("inv",{})
	
	async function loadPage() {
		get("clearinvbutton").addEventListener("click",e=>clearInventory());

		await loadAllPrefs();
		await loadData();
		get("skipLink").href = "#inventory";
		await insertPrefElements({include:["hideExtraIcons","themeDropdown"]});

		var itemKeys = [];
		for(let i in itemDB) {
			// if(itemDB[i].include == false) continue;
			itemKeys.push(i);
		}
		orderItems(itemKeys);
		for(let i in itemKeys) {
			get("items").appendChild(new gcItemIconInput(itemKeys[i],inv[itemKeys[i]]));
		}
		get("items").removeChild(get("loading"));
	};

	function saveItem(element) {
		let itemName = underscoreToSpace(element.id.slice(13))
		let itemCount = element.valueAsNumber
		if(isNaN(itemCount) || itemCount <= 0) {
			delete inv[itemName]
		} else {
			inv[itemName] = itemCount;
		}
		if(JSON.stringify(inv) === "{}") {
			clearLSItem("inv");
		} else {
			setLSItem("inv",JSON.stringify(inv));
		}
	}


	loadPage();
	</script>
</html>